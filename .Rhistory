source('~/Research Assistant/PBL project/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
Sys.getenv()
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
setwd("C:/Users/BiancaClavio")
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
Sys.getenv()
library(splines)
library(car)
library(sandwich)
library(RcmdrMisc)
library(Rcmdr)
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
glm()
myWD2 <- ifelse(grep("BiancaClavio", getwd()), 'C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades', '~/Dropbox/drop out initiative/stats on grades/')
setwd(myWD2)
dfUD1 <-read.csv("RawDataOnlyUD1Engl.csv", header = TRUE, fill=TRUE, sep = ",")
dfUD1$status<-dfUD1$status2015
dfUD1$statusYear<-2015
df2016<-read.csv("RawDataOnlyUD1Engl2016.csv", header = TRUE, fill=TRUE, sep = ",")
df2016$status<-df2016$status2016
df2016$statusYear<-2016
df2016<-plyr::rename(df2016,c("cprnr"="cprnr", "optag_aar"="yearOfEnrolment", "efter_adgeksamen"="delayAfterGraduationFromGymnEtc", "ADGGRU"="ADGGRU", "kvotient"="waitTimeAdjustedGradeInclBonus", "geobag"="residenceBeforeEnrolment", "Aldop"="ageAtEnrolment", "NAVN"="FullName", "postnr"="zip", "geoinst"="GraduationSchoolArea", "institution"="graduationSchool", "campus"="campus", "kon"="gender", "type_optag"="degreeEnrolledFor", "ramme_retning_optag"="studyDirectionAtUniEnrolment", "ramme_2016"="studyDirectionInYear", "orlov2016"="studyLeaveInYear", "studienaevn2016"="studyboardResponsibleInYear", "MAT"="mathGrade", "Niveau_MAT"="mathLevel", "DAN"="DanishGrade", "Niveau_DAN"="DanishLevel", "ENG"="EnglishGrade", "NIveau_ENG"="EnglishLevel", "staa"="staa"
))
dfUD1<-rbind.fill(dfUD1,df2016)
dfUD1$campus<-factor(dfUD1$campus,levels=c("Aalborg","Kbh.","Esbjerg"))
lookupDropOutsVector=c(Afsluttet= 0, Afbrudt=1, Indskrevet=0, 'Afbrudt (School skift)'=1,'Afbrudt(Fak skift)'=1,'Afbrudt (SN skift)'=1)
lookupDropOutsiUniVector=c(Afsluttet= 0, Afbrudt=1, Indskrevet=0, 'Afbrudt (School skift)'=0,'Afbrudt(Fak skift)'=0,'Afbrudt (SN skift)'=0)
dfUD1$isDropOutButInUni<-lookupDropOutsiUniVector[as.character(dfUD1$status)]
dfUD1$isDropOut<-lookupDropOutsVector[as.character(dfUD1$status)]
dfUD1$isInternationalStudent<-ifelse(dfUD1$GraduationSchoolArea=="Ikke Danmark",1,0)
dfUD1$mathGradeBinned<-cut(dfUD1$mathGrade,breaks=c(-6,-1,1.5,3,5.5,8.5,11,18))
dfUD1$mathGradeBinHighGran<-cut(dfUD1$mathGrade,breaks=c(-6,-1,1.5,3,4.5,5.5,6.5,7.5,8.5,11,18))
dfUD1<-dfUD1[!is.na(dfUD1$mathGrade),]
dfUD1$mathLevelABC<-dfUD1$mathLevel
dfUD1$mathLevel<-ifelse(dfUD1$mathLevel %in% c("B","C"),"B","A" )
dfCG <-read.csv("RawDataOnlyUD3-googleDocs.csv", header = TRUE, fill=TRUE, sep = ",")
dfCG$Kvotient<-NULL
dropOutByMathGradeByCampusBy<-sqldf("select mathGradeBinned, campus, mathLevel, avg(isDropOut) as dropOutPct, count(campus) as CountOfStudents from dfM where mathLevel<>''  group by  campus, mathLevel,mathGradeBinned")
ggplot(dropOutByMathGradeByCampusBy,aes(mathGradeBinned,dropOutPct*100,colour=mathLevel))+theme_bw()+scale_y_continuous(limits=c(0,100),breaks=seq(0,100,10)) +geom_point(aes(size=CountOfStudents,alpha=.5))+geom_line()+ylab("% dropped out by 2017")+theme(strip.text.x = element_text(size = 18),legend.position = "bottom",panel.background=element_rect(fill = "white",color = "white"),  axis.text.x  = element_text(size=16),axis.text.y  = element_text(size=16), panel.spacing = unit(2, "lines"),plot.margin=unit(c(0,1,0,0),"lines")  )+guides(alpha=FALSE)+facet_grid(. ~ campus)
myvars<-names(dfM3y) %in% c("isDropOut","MAT_Niveau", "MATGrade")
dataForModel<-dfM3y[myvars]
source('C:/Users/BiancaClavio/Dropbox/drop out initiative/stats on grades/AnalysisBasics.R', echo=TRUE)
