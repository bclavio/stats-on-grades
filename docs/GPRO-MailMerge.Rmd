
```{r setup, include=FALSE}
library(xlsx)
library(sqldf)
library(plyr)
library(dplyr)
library(reshape2)
library(MASS)
library(manipulate)
library(stringr)
library(CTT)
library(Hmisc)
library(psych)
library(ggplot2)
library(ggpubr)
library(gtable)
library(cowplot)

# Setting the directory for knitr, as the dir is reset after running a code chunk.
library(knitr)
library(kableExtra)

opts_knit$set(root.dir = if(grepl("BiancaClavio", getwd())){'C:/Users/BiancaClavio/Documents/SVN/01Projects/GPRO'} else {paste(homeDir,"~/SVN/01Projects/GPRO/", sep = "")})

# homeDir<-Sys.getenv("HOME")

```


 
```{r include=FALSE, warning=FALSE}
personalized_infoGPROGPRO <- read.csv("studentDataGPRO.csv", stringsAsFactors = FALSE)
personalized_info <- personalized_info[,-1]
campus <- personalized_infoGPROGPRO$Campus[i]
name <- personalized_infoGPROGPRO$Name[i]
rowID <- personalized_infoGPRO$rowID[i]

```

---
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead[RE,RO]{`r name`}
- \fancyhead[LE,LO]{Medialogy, `r campus`, 2017}
- \fancyfoot[CE,CO]{MIDTERM EXAM IN GPRO}
- \fancyfoot[LE,RO]{\thepage}
output:
  pdf_document: default
urlcolor: blue
---


# Midterm Exam - Student Report

This is an interpretive report of your responses to the midterm exam in introduction to programming (GPRO). Its purpose is to help you identify your strengths and weaknesses in the course topics.

The boxplots[^1]  show how you compare to a larger sample of first semester Medialogy students from Aalborg and Copenhagen. Specifically, they indicate the average score of all students in eleven different topics (see Figure 1). Your score for each topic is indicated with red dots. A score above 0.5 means that you performed better than the average student in the test. The percentiles indicate the percentage of students whose scores are equal to or less than yours. 

[^1]: A *boxplot* consists of four equal sized groups made from the ordered scores, i.e. 25% of all scores are placed in each group. The lines dividing the groups are called quartiles. The rectangular box denotes the middle 50% of scores for the group, and its lengyh is equal to the difference between the 75th and 25th percentiles. The median (middle quartile) marks the mid-point of the data, indicated as the line dividing the box into two parts. The upper and lower lines (also called whiskers) represent scores outside the middle 50%. Outliers are defined as data points outside the whiskers and plotted as black dots. 



```{r include=FALSE}

student <- subset(avgMidtermGradesMelt, avgMidtermGradesMelt$rowID == i)

avgMidtermGradesMelt$variable <- gsub("\\.", " ", avgMidtermGradesMelt$variable)
avgMidtermGradesMelt$variable <- factor(avgMidtermGradesMelt$variable,
  levels = c('If statements', 'Functions', 'Loops',
  'Nesting','Logical expressions','Mouse and keyboard input',
  'Math and expressions','Data type','Variables',
  'General knowledge','Programming rules'),ordered = TRUE)

pScore <- ggplot(avgMidtermGradesMelt, aes(x=variable, y=value)) +
  geom_boxplot() + 
  coord_flip() +
  labs(y="Figure 1: Boxplots of the scores of all students in eleven topic.") +
  geom_dotplot(data = student,
               aes(x=variable, y=value, fill = "student data"),
               binaxis='y',
               stackdir='center',
               binwidth = 0.05) +
  theme_bw() +
  #facet_grid(Campus ~ .) +
  theme(plot.margin = margin(35, 1, 1, 1),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        #axis.title.x=element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position="none")

```


```{r include=FALSE, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE} 
studentTable <- melt(subset(personalized_infoGPRO[,-c(1,13, 25:28)], personalized_infoGPRO$rowID %in% personalized_infoGPRO$rowID[i]))
studentTable1<- NULL
studentTable1 <- data.frame(c(studentTable[-c(1:11),-c(1)]), apply(studentTable[-c(12:22), ], 2, rev))
studentTable1 <- studentTable1[, c(2,3,1)]
names(studentTable1)[2]<-"Your score"
names(studentTable1)[3]<-"Percentile rank"
row.names(studentTable1) <- NULL
studentTable1$`Your score` <- as.numeric(levels(studentTable1$`Your score`))[studentTable1$`Your score`]
studentTable1 <- studentTable1[,-c(1)]

is.num <- sapply(studentTable1, is.numeric)
studentTable1[is.num] <- sapply(studentTable1[is.num], round, 2)
studentTable1$`Percentile rank` <- round(as.numeric(studentTable1$`Percentile rank`), digits = 0)
studentTable1 <- rbind(studentTable1, c(" "))


tabData <- ggtexttable(studentTable1, rows = NULL, theme = ttheme(base_style = "blank", padding = unit(c(2, 5.5), "mm")))
showAnalysis <- ggarrange(pScore, tabData, ncol = 2, nrow = 1, align = "h", widths = c(2.5,1.5))
```

```{r, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
showAnalysis

```


